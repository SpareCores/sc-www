<div class="w-full bg-primary">
  <div class="content pt-16 pb-16 text-white flex flex-col gap-8">
    <app-breadcrumbs [segments]="breadcrumbs"></app-breadcrumbs>
    <h1 class="text-4xl font-bold mx-2 xl:mx-0">Regions</h1>
    <div class="text-white text-xl pr-16 mx-2 xl:mx-0">
      Currently we are tracking {{ regions.length }} regions at
      {{ vendors.length }} cloud provider vendors as part of the
      <a
        href="/#project_components"
        class="underline decoration-dotted hover:text-gray-500"
        >SC Crawler project</a
      >:
    </div>

    @if (vendors.length) {
      <div class="vendor_labels mt-4 mb-4 flex gap-6 mx-2 xl:mx-0">
        @for (vendor of vendors; track vendor.vendor_id) {
          <div
            class="vendor_label cursor-pointer"
            tabindex="0"
            (click)="toggleVendorSelected(vendor.vendor_id)"
            [ngClass]="{
              'line-through': !isVendorSelected(vendor.vendor_id),
            }"
          >
            <div class="color_circle" [style]="getColorStyle(vendor)"></div>
            {{ vendor.name }}
          </div>
        }
      </div>
    }

    <div
      class="text-black datamaps_div mx-2 xl:mx-0"
      id="datamapdiv"
      #datamapdiv
    ></div>

    <table class="items_table mx-2 xl:mx-0">
      <thead>
        <tr>
          <th class="cursor-pointer" (click)="toggleOrdering('region')">
            <div class="flex gap-1">
              REGION
              @if (getOrderingIcon("region")) {
                <lucide-icon
                  name="{{ getOrderingIcon('region') }}"
                  class="h-4 w-4 text-white"
                ></lucide-icon>
              }
            </div>
          </th>
          <th class="cursor-pointer" (click)="toggleOrdering('vendor')">
            <div class="flex gap-1">
              VENDOR
              @if (getOrderingIcon("vendor")) {
                <lucide-icon
                  name="{{ getOrderingIcon('vendor') }}"
                  class="h-4 w-4 text-white"
                ></lucide-icon>
              }
            </div>
          </th>
          <th class="cursor-pointer" (click)="toggleOrdering('country')">
            <div class="flex gap-1">
              COUNTRY
              @if (getOrderingIcon("country")) {
                <lucide-icon
                  name="{{ getOrderingIcon('country') }}"
                  class="h-4 w-4 text-white"
                ></lucide-icon>
              }
            </div>
          </th>
          <th>
            <div class="flex gap-1">FOUNDING YEAR</div>
          </th>
          <th></th>
        </tr>
      </thead>
      <tbody>
        @for (
          region of regions;
          track region.vendor_id + "_" + region.region_id
        ) {
          <tr (click)="openLink(region)">
            <td>
              <div class="flex gap-1">
                {{ region.display_name }}
                @if (region.green_energy) {
                  <lucide-icon
                    name="leaf"
                    class="h-4 w-4 text-emerald-400"
                  ></lucide-icon>
                }
              </div>
            </td>
            <td>{{ getVendorName(region.vendor_id) }}</td>
            <td>{{ region.country_id | countryIdtoName }}</td>
            <td>{{ region.founding_year || "-" }}</td>
            <td>
              <div class="flex justify-end" (click)="$event.stopPropagation()">
                <a
                  routerLink="/server_prices"
                  [queryParams]="{ regions: region.region_id }"
                >
                  <lucide-icon
                    name="chevron-right"
                    class="h-6 w-6 text-emerald-400"
                  ></lucide-icon>
                </a>
              </div>
            </td>
          </tr>
        }
      </tbody>
    </table>
  </div>
</div>
