<div class="w-full bg-primary">
  <div class="content pt-16 pb-16 text-white flex flex-col gap-8">
    <app-breadcrumbs [segments]="breadcrumbs"></app-breadcrumbs>
    <h1 class="text-4xl font-bold">Benchmark Completion Report</h1>
    <div class="text-white text-xl pr-16">
      Although we try hard, we were not able to start some instances for
      hardware inspections and to run our benchmark workloads. You can find a
      breakdown of these servers, including the likely root cause for the
      missing data.
    </div>

    <table class="items_table">
      <thead>
        <tr>
          <th>
            <div class="flex gap-1">VENDOR</div>
          </th>
          <th>
            <div class="flex justify-end">IDENTIFIED SERVERS</div>
          </th>
          <th>
            <div class="flex justify-end">ACTIVE SERVERS</div>
          </th>
          <th>
            <div class="flex justify-end">EVALUATED SERVERS</div>
          </th>
          <th>
            <div class="flex justify-end">MISSING SERVERS</div>
          </th>
          <th>
            <div class="flex justify-end">MISSING RATE</div>
          </th>
        </tr>
      </thead>
      <tbody>
        @for (vendor of vendors; track vendor.vendor_id) {
          <tr>
            <td>
              <div class="flex gap-1">
                {{ vendor.name }}
              </div>
            </td>
            <td>
              <div class="flex justify-end">
                {{ vendor.servers }}
              </div>
            </td>
            <td>
              <div class="flex justify-end">
                {{ vendor.active_servers }}
              </div>
            </td>
            <td>
              <div class="flex justify-end">
                {{ vendor.evaluated }}
              </div>
            </td>
            <td>
              <div class="flex justify-end">
                {{ vendor.missing }}
              </div>
            </td>
            <td>
              <div class="flex justify-end">{{ vendor.percentage }}%</div>
            </td>
          </tr>
        }
      </tbody>
    </table>

    @for (vendor of vendors; track vendor.vendor_id) {
      <div>
        @if (vendor.missing_servers?.length) {
          <div class="flex flex-col gap-2">
            <h2
              class="text-3xl mb-2 flex items-center gap-3 cursor-pointer hover:opacity-80 transition-opacity"
              (click)="toggleVendor(vendor.id)"
            >
              <lucide-icon
                [name]="isVendorExpanded(vendor.id) ? 'chevron-down' : 'chevron-right'"
                class="h-8 w-8 flex-shrink-0"
              ></lucide-icon>
              <span>{{ vendor.name }} ({{ vendor.servers }} servers)</span>
            </h2>
            @if (isVendorExpanded(vendor.id)) {
              <table class="items_table ml-11">
              <thead>
                <tr>
                  <th>
                    <div class="flex gap-1">SERVER</div>
                  </th>
                  <th>
                    <div class="flex gap-1">MISSING REASON</div>
                  </th>
                </tr>
              </thead>
              <tbody>
                @for (
                  server of vendor.missing_servers;
                  track server.vendor_id + "_" + server.server_id
                ) {
                  <tr>
                    <td>
                      <div class="pl-2 flex gap-1">
                        {{ server.name }}
                      </div>
                    </td>
                    <td>
                      <div class="flex gap-1">
                        {{ server.reason }}
                      </div>
                    </td>
                  </tr>
                }
              </tbody>
            </table>
            }
          </div>
        }
      </div>
    }
  </div>
</div>
